const deleteButtonP1=document.getElementById("deleteScoreP1Button"),deleteButtonP2=document.getElementById("deleteScoreP2Button");let dartsGame={_players:[{firstName:"",lastName:"",dartsName:""},{firstName:"",lastName:"",dartsName:""}],_playerGo:0,_game:[{matchesWon:0,canFinish:!1,startingScore:0,remainingScore:0,legsWon:0,totalLegs:0,legsToWin:0},{matchesWon:0,canFinish:!1,startingScore:0,remainingScore:0,legsWon:0,totalLegs:0,legsToWin:0}],_gameStats:[{cumScore:0,scoreAvg:0,dartsThrown:0,visits:0},{cumScore:0,scoreAvg:0,dartsThrown:0,visits:0}],_scoreHistory:[{scores:[]},{scores:[]}],returnFullName(e){return`${this._players[e].firstName} ${this._players[e].dartsName} `+this._players[e].lastName},determineNextPlayer(e){0===e?(this._playerGo=1,submitButtonP1.className="btn bg-secondary bg-gradient",submitButtonP2.className="btn bg-success bg-gradient",submitButtonP2.disabled=!(submitButtonP1.disabled=!0),deleteButtonP1.disabled=!1,deleteButtonP2.disabled=!0):(this._playerGo=0,submitButtonP2.className="btn bg-secondary bg-gradient",submitButtonP1.className="btn bg-success bg-gradient",submitButtonP2.disabled=!(submitButtonP1.disabled=!1),deleteButtonP2.disabled=!1,deleteButtonP1.disabled=!0)},setScore(e,t){0==(this._game[t].remainingScore=this._game[t].remainingScore-e)?(this._scoreHistory[t].scores.push(e),this._gameStats[t].cumScore=e+=this._gameStats[t].cumScore,this._gameStats[t].visits+=1,this._gameStats[t].dartsThrown=this._gameStats[t].dartsThrown+=3,this._gameStats[t].scoreAvg=Math.round(this._gameStats[t].cumScore/this._gameStats[t].visits),this.hasWonLeg(t),this.hasWonGame(t)):(this._scoreHistory[t].scores.push(e),this._gameStats[t].cumScore=e+=this._gameStats[t].cumScore,this._gameStats[t].visits+=1,this._gameStats[t].dartsThrown=this._gameStats[t].dartsThrown+=3,this._gameStats[t].scoreAvg=Math.round(this._gameStats[t].cumScore/this._gameStats[t].visits),this.determineNextPlayer(t),console.log(`Player ${this._playerGo+1} is up next.`))},deleteScore(e){this._game[e].remainingScore=this._game[e].remainingScore+this._scoreHistory[e].scores[this._scoreHistory[e].scores.length-1],this._gameStats[e].cumScore=this._gameStats[e].cumScore-this._scoreHistory[e].scores[this._scoreHistory[e].scores.length-1],this._scoreHistory[e].scores.pop(),0!==this._gameStats[e].dartsThrown&&(this._gameStats[e].dartsThrown=this._gameStats[e].dartsThrown-3),1<this._gameStats[e].visits?(this._gameStats[e].visits=this._gameStats[e].visits-1,this._gameStats[e].scoreAvg=Math.round(this._gameStats[e].cumScore/this._gameStats[e].visits)):(dartsGame._gameStats[e].scoreAvg=0,this._gameStats[e].visits=this._gameStats[e].visits-1)},isOnAFinish(e){return 0===this._game[e].remainingScore?"Well done!":this._game[e].remainingScore<=170?(this._game[e].canFinish=!0,{170:"T20 T20 Bull",167:"T20 T19 Bull",164:"T20 T20 T18",161:"T20 T17 Bull",160:"T20 T20 D20",158:"T20 T20 D19",157:"T20 T19 D20",156:"T20 T20 D18",155:"T20 T19 D19",154:"T20 T18 D20",153:"T20 T19 D18",152:"T20 T20 D16",151:"T20 T17 D20",150:"T20 T18 D18",149:"T20 T19 D16",147:"T20 T17 D18",146:"T20 T18 D16",145:"T20 T15 D20",144:"T20 T20 D12",143:"T20 T17 D16",142:"T20 T14 D20",141:"T20 T19 D12",140:"T20 T20 D10",139:"T19 T14 D20",138:"T20 T18 D12",137:"T20 T19 D10",136:"T20 T20 D8",135:"Bull T15 D20",134:"T20 T14 D16",133:"T20 T19 D8",132:"Bull Bull D16",131:"T20 T13 D16",130:"T20 T20 Bull",129:"T19 T16 D12",128:"T18 T14 D16",127:"T20 T17 D8",126:"T19 T19 D6",125:"Bull T17 D12",124:"T20 S14 Bull",123:"T19 S16 Bull",122:"T18 T18 D7",121:"T20 S11 Bull",120:"T20 S20 D20",119:"T20 S19 D20",118:"T20 S18 D20",117:"T20 S17 D20",116:"T19 S19 D20",115:"T19 S18 D20",114:"T20 S14 D20",113:"T19 S16 D20",112:"T20 S12 D20",111:"T20 S11 D20",110:"T20 S10 D20",109:"T19 S12 D20",108:"T19 S19 D16",107:"T20 S15 D16",106:"T20 S6 D20",105:"T20 S5 D20",104:"T18 S10 D20",103:"T20 S11 D16",102:"T20 S10 D16",101:"T20 S9 D16",100:"T20 D20",98:"T20 D19",97:"T19 D20",96:"T20 D18",95:"T19 D19",94:"T18 D20",93:"T19 D18",92:"T20 D16",91:"T17 D20",90:"T20 D15",89:"T19 D16",88:"T20 D14",87:"T17 D18",86:"T18 D16",85:"T15 D20",84:"T20 D12",83:"T17 D16",82:"Bull D16",81:"T19 D12",80:"T20 D10",79:"T19 D11",78:"T18 D12",77:"T19 D10",76:"T20 D8",75:"T17 D12",74:"T14 D16",73:"T19 D8",72:"T16 D12",71:"T13 D16",70:"T10 D20",69:"T19 D6",68:"T20 D6",67:"T17 D8",66:"T10 D18",65:"Outer Bull D20",64:"T16 D8",63:"T9 D18",62:"T10 D16",61:"Outer Bull D18",60:"S20 D20",59:"S19 D20",58:"S18 D20",57:"S17 D20",56:"S16 D20",55:"S15 D20",54:"S14 D20",53:"S13 D20",52:"S12 D20",51:"S11 D20",50:"S10 D20",49:"S9 D20",48:"S8 D20",47:"S7 D20",46:"S6 D20",45:"S5 D20",44:"S4 D20",43:"S3 D20",42:"S9 D16",41:"S1 D20",40:"D20",39:"S7 D16",38:"D19",37:"S5 D16",36:"D18",35:"S3 D16",34:"D17",33:"D1 D16",32:"D16",31:"S15 D8",30:"D15",29:"S13 D8",28:"D14",27:"S11 D8",26:"D13",25:"S9 D8",24:"D12",23:"11 D6",22:"D11",21:"S5 D8",20:"D10",19:"S3 D8",18:"D9",17:"S1 D8",16:"D8",15:"7 D4",14:"D7",13:"S5 D4",12:"D6",11:"S3 D4",10:"D5",9:"S1 D4",8:"D4",7:"S3 D2",6:"D3",5:"S1 D2",4:"D2",3:"S1 D1",2:"D1",1:"Bust"}[this._game[e].remainingScore]):void(this._game[e].canFinish=!1)},hasWonLeg(e){0===this._game[e].remainingScore&&(submitButtonP1.className="btn bg-secondary bg-gradient",submitButtonP2.className="btn bg-secondary bg-gradient",nextLegButton.disabled=!1,nextLegButton.className="btn bg-success bg-gradient",this._game[e].legsWon+=1,this.determineNextPlayer(e),alert(`Well done! ${this.returnFullName(e)} wins this leg! Click 'Next Leg' button to proceed.`))},hasWonGame(e){var t=document.getElementById("matchesWonP1"),a=document.getElementById("newMatch");this._game[e].legsWon===this._game[e].legsToWin&&(submitButtonP1.className="btn bg-secondary bg-gradient",submitButtonP2.className="btn bg-secondary bg-gradient",submitButtonP1.disabled=!0,deleteButtonP1.disabeld=!0,deleteButtonP2.disabled=!0,submitButtonP2.disabeld=!0,nextLegButton.className="btn bg-secondary bg-gradient",nextLegButton.disabled=!0,nextLegButton.innerText="No more legs",dartsGame._game[e].matchesWon+=1,t.innerText=dartsGame._game[e].matchesWon,a.className="btn bg-success bg-gradient",console.log(`${this.returnFullName(e)} has won ${this._game[e].legsWon} of `+this._game[e].totalLegs),alert(`Well done! ${this.returnFullName(e)} wins the game!!`))}};function loadGameData(){var e=sessionStorage.getItem("dartsGameData");parsedGameData=JSON.parse(e),dartsGame._game[0]=parsedGameData._game[0],dartsGame._game[1]=parsedGameData._game[1],dartsGame._players[0]=parsedGameData._players[0],dartsGame._players[1]=parsedGameData._players[1],dartsGame._playerGo=parsedGameData._playerGo,updateScoreDisplayP1(),updateScoreDisplayP2(),1===dartsGame._playerGo?(submitButtonP1.className="btn bg-secondary bg-gradient",submitButtonP2.className="btn bg-success bg-gradient",submitButtonP2.disabled=!(submitButtonP1.disabled=!0),deleteButtonP1.disabled=!0):(submitButtonP1.className="btn bg-success bg-gradient",submitButtonP2.className="btn bg-secondary bg-gradient",submitButtonP2.disabled=!(submitButtonP1.disabled=!1),deleteButtonP2.disabled=!0)}loadGameData();const matchOverview=document.getElementById("matchOverview");function updateScoreDisplayP1(e){document.getElementById("gameScoreP1").innerText=dartsGame._game[0].remainingScore,console.log("Updated score to "+dartsGame._game[0].remainingScore)}function updateScoreDisplayP2(e){document.getElementById("gameScoreP2").innerText=dartsGame._game[1].remainingScore,console.log("Updated score to "+dartsGame._game[1].remainingScore)}function showHistoryP1(){0!==dartsGame._scoreHistory[0].scores.length?document.getElementById("scoreHistoryP1").innerText=dartsGame._scoreHistory[0].scores[dartsGame._scoreHistory[0].scores.length-1]:document.getElementById("scoreHistoryP1").innerText=0}function showHistoryP2(){0!==dartsGame._scoreHistory[1].scores.length?document.getElementById("scoreHistoryP2").innerText=dartsGame._scoreHistory[1].scores[dartsGame._scoreHistory[1].scores.length-1]:document.getElementById("scoreHistoryP2").innerText=0}function updateStatsP1(){var e=document.getElementById("dartsThrownP1"),t=document.getElementById("AvgNumP1");e.innerText=dartsGame._gameStats[0].dartsThrown,t.innerText=dartsGame._gameStats[0].scoreAvg,console.log("Updated darts thrown to "+dartsGame._gameStats[0].dartsThrown),console.log("Updated average score to "+dartsGame._gameStats[0].scoreAvg)}function updateStatsP2(){var e=document.getElementById("dartsThrownP2"),t=document.getElementById("AvgNumP2");e.innerText=dartsGame._gameStats[1].dartsThrown,t.innerText=dartsGame._gameStats[1].scoreAvg,console.log("Updated darts thrown to "+dartsGame._gameStats[1].dartsThrown),console.log("Updated average score to "+dartsGame._gameStats[1].scoreAvg)}function showFinishP1(){var e=document.getElementById("finishDisplayP1"),t=dartsGame.isOnAFinish(0);dartsGame._game[0].remainingScore<=170?(e.className="bg-success bg-gradient text-white",e.innerText=t,console.log("Finish displayed "+t)):(e.className="",e.innerText="",console.log("No finish available"))}function showFinishP2(){var e=document.getElementById("finishDisplayP2"),t=dartsGame.isOnAFinish(1);dartsGame._game[1].remainingScore<=170?(e.className="bg-success bg-gradient text-white",e.innerText=t,console.log("Finish displayed "+t)):(e.className="",e.innerText="",console.log("No finish available"))}function nextLeg(){var e,t;0===dartsGame._game[0].legsToWin&&0===dartsGame._game[1].legsToWin||(e=document.getElementById("legsWonP1"),t=document.getElementById("legsWonP2"),e.innerText=dartsGame._game[0].legsWon,t.innerText=dartsGame._game[1].legsWon)}matchOverview.innerText=`Game on: ${dartsGame._game[0].startingScore} - best of ${dartsGame._game[0].totalLegs} legs!`,document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("nextLegButton");e.disabled=!0;var t=document.getElementById("player1"),a=document.getElementById("player2"),t=(t.innerText=dartsGame.returnFullName(0),a.innerText=dartsGame.returnFullName(1),document.getElementById("submitButtonP1"));const s=document.getElementById("scoreInputP1");a=document.getElementById("submitButtonP2");const n=document.getElementById("scoreInputP2");e.addEventListener("click",function(){dartsGame._scoreHistory=[{scores:[]},{scores:[]}],dartsGame._game[0].remainingScore=501,dartsGame._game[1].remainingScore=501,dartsGame._game[0].canFinish=!1,dartsGame._game[1].canFinish=!1,dartsGame._gameStats[0].dartsThrown=0,dartsGame._gameStats[1].dartsThrown=0,dartsGame._playerGo,e.disabled=!0,e.className="btn bg-secondary bg-gradient",updateStatsP1(),updateStatsP2(),updateScoreDisplayP1(),updateScoreDisplayP2(),showFinishP1(),showFinishP2(),showHistoryP1(),showHistoryP2()}),t.addEventListener("click",function(){var e=parseInt(s.value);180<e?alert("Score higher than maximum allowed."):e>dartsGame._game[0].remainingScore||dartsGame._game[0].remainingScore-e==1?alert("Invalid score."):isNaN(e)?alert("Please enter a valid number."):(dartsGame.setScore(e,0),updateScoreDisplayP1(e),updateStatsP1(),showHistoryP1(),showFinishP1(),s.value="",nextLeg(),n.focus())}),a.addEventListener("click",function(){var e=parseInt(n.value);180<e?alert("Score higher than maximum allowed."):e>dartsGame._game[1].remainingScore||dartsGame._game[1].remainingScore-e==1?alert("Invalid score."):isNaN(e)?alert("Please enter a valid number."):(dartsGame.setScore(e,1),updateStatsP2(),updateScoreDisplayP2(e),showHistoryP2(),showFinishP2(),n.value="",nextLeg(),s.focus())}),deleteButtonP1.addEventListener("click",function(){dartsGame._game[0].startingScore!==dartsGame._game[0].remainingScore?(dartsGame.deleteScore(0),dartsGame.determineNextPlayer(dartsGame._playerGo),updateStatsP1(),updateScoreDisplayP1(),showFinishP1(),showHistoryP1()):window.alert("No darts thrown, nothing to undo.")}),deleteButtonP2.addEventListener("click",function(){dartsGame._game[1].startingScore!==dartsGame._game[1].remainingScore?(dartsGame.deleteScore(1),dartsGame.determineNextPlayer(dartsGame._playerGo),updateStatsP2(),updateScoreDisplayP2(),showFinishP2(),showHistoryP2()):window.alert("No darts thrown, nothing to undo.")}),newMatch.addEventListener("click",function(){window.location.href="index.html",newMatch.className="btn bg-secondary bg-gradient"})});
